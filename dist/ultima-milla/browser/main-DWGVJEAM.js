import{$ as c,$a as R,A as g,Aa as si,Ab as Xe,B as W,Ba as _e,Bb as Ze,C as ge,Ca as mi,Cb as Ke,D as zt,Da as li,Db as Ye,E as Lt,Ea as X,Eb as Je,F as d,Fa as oe,Fb as et,G as Q,Ga as N,Gb as tt,H as u,Ha as ce,Hb as it,I as Se,Ia as Te,Ib as de,J as ne,Ja as di,K as Ht,Ka as Pe,Kb as nt,L as Ut,La as Oe,M as o,Ma as Fe,N as r,Na as pi,O as p,Oa as ui,Ob as Y,P as _,Pa as Re,Pb as at,Q as v,Qa as se,Qb as pe,R as De,Ra as Ve,Rb as yi,S as P,Sa as me,Sb as rt,T as h,Ta as Be,Tb as Si,U as y,Ua as Ne,V as $t,Va as fi,W as qt,Wa as j,X as E,Xa as Z,Y as k,Ya as z,Z as A,Za as L,_ as Gt,_a as je,a as ie,aa as I,ab as V,b as It,ba as b,bb as H,c as q,ca as Wt,cb as K,d as Tt,da as Qt,db as wt,e as Pt,ea as Xt,eb as hi,fa as ae,fb as gi,g as xt,ga as ee,gb as yt,h as Ot,ha as Ee,hb as _i,i as xe,ia as ke,ib as ze,j as G,ja as Zt,jb as vi,k as J,ka as Kt,kb as bi,l as C,la as Yt,lb as Ci,m as M,ma as Ae,mb as Le,n as w,na as Jt,nb as He,o as Mt,oa as Ie,ob as le,p as Ft,pa as re,pb as xi,q as Me,qa as ei,qb as Mi,r as Rt,ra as ti,rb as Ue,s as we,sa as ii,sb as $e,t as ye,ta as O,tb as U,u as Vt,ua as ni,ub as D,v as Bt,va as ai,vb as wi,w as Nt,wa as ri,wb as qe,x as m,xa as oi,xb as Ge,y as jt,ya as F,yb as We,z as f,za as ci,zb as Qe}from"./chunk-X3YI3SXE.js";var zi=["determinateSpinner"];function Li(t,i){if(t&1&&(Mt(),o(0,"svg",11),p(1,"circle",12),r()),t&2){let e=y();Q("viewBox",e._viewBox()),m(),Se("stroke-dasharray",e._strokeCircumference(),"px")("stroke-dashoffset",e._strokeCircumference()/2,"px")("stroke-width",e._circleStrokeWidth(),"%"),Q("r",e._circleRadius())}}var Hi=new J("mat-progress-spinner-default-options",{providedIn:"root",factory:Ui});function Ui(){return{diameter:Di}}var Di=100,$i=10,Ei=(()=>{class t{_elementRef=C(we);_noopAnimations;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;_defaultColor="primary";_determinateCircle;constructor(){let e=C(ye,{optional:!0}),n=C(Hi);this._noopAnimations=e==="NoopAnimations"&&!!n&&!n._forceAnimations,this.mode=this._elementRef.nativeElement.nodeName.toLowerCase()==="mat-spinner"?"indeterminate":"determinate",n&&(n.color&&(this.color=this._defaultColor=n.color),n.diameter&&(this.diameter=n.diameter),n.strokeWidth&&(this.strokeWidth=n.strokeWidth))}mode;get value(){return this.mode==="determinate"?this._value:0}set value(e){this._value=Math.max(0,Math.min(100,e||0))}_value=0;get diameter(){return this._diameter}set diameter(e){this._diameter=e||0}_diameter=Di;get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(e){this._strokeWidth=e||0}_strokeWidth;_circleRadius(){return(this.diameter-$i)/2}_viewBox(){let e=this._circleRadius()*2+this.strokeWidth;return`0 0 ${e} ${e}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return this.mode==="determinate"?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=g({type:t,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(n,a){if(n&1&&E(zi,5),n&2){let s;k(s=A())&&(a._determinateCircle=s.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:18,hostBindings:function(n,a){n&2&&(Q("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow",a.mode==="determinate"?a.value:null)("mode",a.mode),Ht("mat-"+a.color),Se("width",a.diameter,"px")("height",a.diameter,"px")("--mdc-circular-progress-size",a.diameter+"px")("--mdc-circular-progress-active-indicator-width",a.diameter+"px"),ne("_mat-animation-noopable",a._noopAnimations)("mdc-circular-progress--indeterminate",a.mode==="indeterminate"))},inputs:{color:"color",mode:"mode",value:[2,"value","value",Ae],diameter:[2,"diameter","diameter",Ae],strokeWidth:[2,"strokeWidth","strokeWidth",Ae]},exportAs:["matProgressSpinner"],decls:14,vars:11,consts:[["circle",""],["determinateSpinner",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(n,a){if(n&1&&(d(0,Li,2,8,"ng-template",null,0,Zt),o(2,"div",2,1),Mt(),o(4,"svg",3),p(5,"circle",4),r()(),Ft(),o(6,"div",5)(7,"div",6)(8,"div",7),De(9,8),r(),o(10,"div",9),De(11,8),r(),o(12,"div",10),De(13,8),r()()()),n&2){let s=Gt(1);m(4),Q("viewBox",a._viewBox()),m(),Se("stroke-dasharray",a._strokeCircumference(),"px")("stroke-dashoffset",a._strokeDashOffset(),"px")("stroke-width",a._circleStrokeWidth(),"%"),Q("r",a._circleRadius()),m(4),u("ngTemplateOutlet",s),m(2),u("ngTemplateOutlet",s),m(2),u("ngTemplateOutlet",s)}},dependencies:[ei],styles:[".mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0;position:relative;direction:ltr;transition:opacity 250ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width, 4px)}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1;animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color, var(--mat-sys-primary))}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}"],encapsulation:2,changeDetection:0})}return t})();var ki=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=W({type:t});static \u0275inj=G({imports:[X]})}return t})();var ot=class t{constructor(i){this.router=i}ngOnInit(){setTimeout(()=>{this.router.navigate(["/login"])},3e3)}static \u0275fac=function(e){return new(e||t)(f(F))};static \u0275cmp=g({type:t,selectors:[["app-home"]],decls:3,vars:1,consts:[["src","assets/vivipra.png","alt","Vivipra logo"],[1,"custom-spinner",3,"diameter"]],template:function(e,n){e&1&&(o(0,"div"),p(1,"img",0)(2,"mat-spinner",1),r()),e&2&&(m(2),u("diameter",65))},dependencies:[ki,Ei],styles:["div[_ngcontent-%COMP%]{display:flex;height:100vh;justify-content:center;align-items:center;text-align:center;flex-direction:column}img[_ngcontent-%COMP%]{width:30rem}@media (max-width: 1024px){div[_ngcontent-%COMP%]{width:50vh}img[_ngcontent-%COMP%]{width:15rem}}"]})};var Gi=["*"];var Wi=new J("MAT_CARD_CONFIG"),Ai=(()=>{class t{appearance;constructor(){let e=C(Wi,{optional:!0});this.appearance=e?.appearance||"raised"}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=g({type:t,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(n,a){n&2&&ne("mat-mdc-card-outlined",a.appearance==="outlined")("mdc-card--outlined",a.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:Gi,decls:1,vars:0,template:function(n,a){n&1&&($t(),qt(0))},styles:['.mat-mdc-card{display:flex;flex-direction:column;box-sizing:border-box;position:relative;border-style:solid;border-width:0;background-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium));box-shadow:var(--mdc-elevated-card-container-elevation, var(--mat-sys-level1))}.mat-mdc-card::after{position:absolute;top:0;left:0;width:100%;height:100%;border:solid 1px rgba(0,0,0,0);content:"";display:block;pointer-events:none;box-sizing:border-box;border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium))}.mat-mdc-card-outlined{background-color:var(--mdc-outlined-card-container-color, var(--mat-sys-surface));border-radius:var(--mdc-outlined-card-container-shape, var(--mat-sys-corner-medium));border-width:var(--mdc-outlined-card-outline-width, 1px);border-color:var(--mdc-outlined-card-outline-color, var(--mat-sys-outline-variant));box-shadow:var(--mdc-outlined-card-container-elevation, var(--mat-sys-level0))}.mat-mdc-card-outlined::after{border:none}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mat-mdc-card-actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font, var(--mat-sys-title-large-font));line-height:var(--mat-card-title-text-line-height, var(--mat-sys-title-large-line-height));font-size:var(--mat-card-title-text-size, var(--mat-sys-title-large-size));letter-spacing:var(--mat-card-title-text-tracking, var(--mat-sys-title-large-tracking));font-weight:var(--mat-card-title-text-weight, var(--mat-sys-title-large-weight))}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color, var(--mat-sys-on-surface));font-family:var(--mat-card-subtitle-text-font, var(--mat-sys-title-medium-font));line-height:var(--mat-card-subtitle-text-line-height, var(--mat-sys-title-medium-line-height));font-size:var(--mat-card-subtitle-text-size, var(--mat-sys-title-medium-size));letter-spacing:var(--mat-card-subtitle-text-tracking, var(--mat-sys-title-medium-tracking));font-weight:var(--mat-card-subtitle-text-weight, var(--mat-sys-title-medium-weight))}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0})}return t})();var Ii=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=W({type:t});static \u0275inj=G({imports:[X,X]})}return t})();var Ti=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=W({type:t});static \u0275inj=G({})}return t})(),st={XSmall:"(max-width: 599.98px)",Small:"(min-width: 600px) and (max-width: 959.98px)",Medium:"(min-width: 960px) and (max-width: 1279.98px)",Large:"(min-width: 1280px) and (max-width: 1919.98px)",XLarge:"(min-width: 1920px)",Handset:"(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)",Tablet:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait), (min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",Web:"(min-width: 840px) and (orientation: portrait), (min-width: 1280px) and (orientation: landscape)",HandsetPortrait:"(max-width: 599.98px) and (orientation: portrait)",TabletPortrait:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait)",WebPortrait:"(min-width: 840px) and (orientation: portrait)",HandsetLandscape:"(max-width: 959.98px) and (orientation: landscape)",TabletLandscape:"(min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",WebLandscape:"(min-width: 1280px) and (orientation: landscape)"};function Zi(t,i){if(t&1){let e=P();o(0,"div",1)(1,"button",2),h("click",function(){M(e);let a=y();return w(a.action())}),c(2),r()()}if(t&2){let e=y();m(2),b(" ",e.data.action," ")}}var Ki=["label"];function Yi(t,i){}var Ji=Math.pow(2,31)-1,ve=class{_overlayRef;instance;containerInstance;_afterDismissed=new q;_afterOpened=new q;_onAction=new q;_durationTimeoutId;_dismissedByAction=!1;constructor(i,e){this._overlayRef=e,this.containerInstance=i,i._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(i){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(i,Ji))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}},Pi=new J("MatSnackBarData"),ue=class{politeness="assertive";announcementMessage="";viewContainerRef;duration=0;panelClass;direction;data=null;horizontalPosition="center";verticalPosition="bottom"},en=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=ge({type:t,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]})}return t})(),tn=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=ge({type:t,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]})}return t})(),nn=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=ge({type:t,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]})}return t})(),Oi=(()=>{class t{snackBarRef=C(ve);data=C(Pi);constructor(){}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=g({type:t,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["mat-button","","matSnackBarAction","",3,"click"]],template:function(n,a){n&1&&(o(0,"div",0),c(1),r(),d(2,Zi,3,1,"div",1)),n&2&&(m(),b(" ",a.data.message,`
`),m(),Ut(a.hasAction?2:-1))},dependencies:[R,en,tn,nn],styles:[".mat-mdc-simple-snack-bar{display:flex}"],encapsulation:2,changeDetection:0})}return t})(),St="_mat-snack-bar-enter",Dt="_mat-snack-bar-exit",an=(()=>{class t extends gi{_ngZone=C(Rt);_elementRef=C(we);_changeDetectorRef=C(Yt);_platform=C(si);_rendersRef;_animationsDisabled=C(ye,{optional:!0})==="NoopAnimations";snackBarConfig=C(ue);_document=C(Jt);_trackedModals=new Set;_enterFallback;_exitFallback;_renders=new q;_announceDelay=150;_announceTimeoutId;_destroyed=!1;_portalOutlet;_onAnnounce=new q;_onExit=new q;_onEnter=new q;_animationState="void";_live;_label;_role;_liveElementId=C(li).getId("mat-snack-bar-container-live-");constructor(){super();let e=this.snackBarConfig;e.politeness==="assertive"&&!e.announcementMessage?this._live="assertive":e.politeness==="off"?this._live="off":this._live="polite",this._platform.FIREFOX&&(this._live==="polite"&&(this._role="status"),this._live==="assertive"&&(this._role="alert")),this._rendersRef=Vt(()=>this._renders.next(),{manualCleanup:!0})}attachComponentPortal(e){this._assertNotAttached();let n=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),n}attachTemplatePortal(e){this._assertNotAttached();let n=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),n}attachDomPortal=e=>{this._assertNotAttached();let n=this._portalOutlet.attachDomPortal(e);return this._afterPortalAttached(),n};onAnimationEnd(e){e===Dt?this._completeExit():e===St&&(clearTimeout(this._enterFallback),this._ngZone.run(()=>{this._onEnter.next(),this._onEnter.complete()}))}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce(),this._animationsDisabled?this._renders.pipe(xt(1)).subscribe(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(St)))}):(clearTimeout(this._enterFallback),this._enterFallback=setTimeout(()=>{this._elementRef.nativeElement.classList.add("mat-snack-bar-fallback-visible"),this.onAnimationEnd(St)},200)))}exit(){return this._destroyed?Pt(void 0):(this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId),this._animationsDisabled?this._renders.pipe(xt(1)).subscribe(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(Dt)))}):(clearTimeout(this._exitFallback),this._exitFallback=setTimeout(()=>this.onAnimationEnd(Dt),200))}),this._onExit)}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit(),this._renders.complete(),this._rendersRef.destroy()}_completeExit(){clearTimeout(this._exitFallback),queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){let e=this._elementRef.nativeElement,n=this.snackBarConfig.panelClass;n&&(Array.isArray(n)?n.forEach(l=>e.classList.add(l)):e.classList.add(n)),this._exposeToModals();let a=this._label.nativeElement,s="mdc-snackbar__label";a.classList.toggle(s,!a.querySelector(`.${s}`))}_exposeToModals(){let e=this._liveElementId,n=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let a=0;a<n.length;a++){let s=n[a],l=s.getAttribute("aria-owns");this._trackedModals.add(s),l?l.indexOf(e)===-1&&s.setAttribute("aria-owns",l+" "+e):s.setAttribute("aria-owns",e)}}_clearFromModals(){this._trackedModals.forEach(e=>{let n=e.getAttribute("aria-owns");if(n){let a=n.replace(this._liveElementId,"").trim();a.length>0?e.setAttribute("aria-owns",a):e.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{if(this._destroyed)return;let e=this._elementRef.nativeElement,n=e.querySelector("[aria-hidden]"),a=e.querySelector("[aria-live]");if(n&&a){let s=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&n.contains(document.activeElement)&&(s=document.activeElement),n.removeAttribute("aria-hidden"),a.appendChild(n),s?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=g({type:t,selectors:[["mat-snack-bar-container"]],viewQuery:function(n,a){if(n&1&&(E(yt,7),E(Ki,7)),n&2){let s;k(s=A())&&(a._portalOutlet=s.first),k(s=A())&&(a._label=s.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container"],hostVars:6,hostBindings:function(n,a){n&1&&h("animationend",function(l){return a.onAnimationEnd(l.animationName)})("animationcancel",function(l){return a.onAnimationEnd(l.animationName)}),n&2&&ne("mat-snack-bar-container-enter",a._animationState==="visible")("mat-snack-bar-container-exit",a._animationState==="hidden")("mat-snack-bar-container-animations-enabled",!a._animationsDisabled)},features:[Lt],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface","mat-mdc-snackbar-surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(n,a){n&1&&(o(0,"div",1)(1,"div",2,0)(3,"div",3),d(4,Yi,0,0,"ng-template",4),r(),p(5,"div"),r()()),n&2&&(m(5),Q("aria-live",a._live)("role",a._role)("id",a._liveElementId))},dependencies:[yt],styles:["@keyframes _mat-snack-bar-enter{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}@keyframes _mat-snack-bar-exit{from{opacity:1}to{opacity:0}}.mat-mdc-snack-bar-container{display:flex;align-items:center;justify-content:center;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);margin:8px}.mat-mdc-snack-bar-handset .mat-mdc-snack-bar-container{width:100vw}.mat-snack-bar-container-animations-enabled{opacity:0}.mat-snack-bar-container-animations-enabled.mat-snack-bar-fallback-visible{opacity:1}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-enter{animation:_mat-snack-bar-enter 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-exit{animation:_mat-snack-bar-exit 75ms cubic-bezier(0.4, 0, 1, 1) forwards}.mat-mdc-snackbar-surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;padding-left:0;padding-right:8px}[dir=rtl] .mat-mdc-snackbar-surface{padding-right:0;padding-left:8px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{min-width:344px;max-width:672px}.mat-mdc-snack-bar-handset .mat-mdc-snackbar-surface{width:100%;min-width:0}@media(forced-colors: active){.mat-mdc-snackbar-surface{outline:solid 1px}}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{color:var(--mdc-snackbar-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mdc-snackbar-container-shape, var(--mat-sys-corner-extra-small));background-color:var(--mdc-snackbar-container-color, var(--mat-sys-inverse-surface))}.mdc-snackbar__label{width:100%;flex-grow:1;box-sizing:border-box;margin:0;padding:14px 8px 14px 16px}[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-family:var(--mdc-snackbar-supporting-text-font, var(--mat-sys-body-medium-font));font-size:var(--mdc-snackbar-supporting-text-size, var(--mat-sys-body-medium-size));font-weight:var(--mdc-snackbar-supporting-text-weight, var(--mat-sys-body-medium-weight));line-height:var(--mdc-snackbar-supporting-text-line-height, var(--mat-sys-body-medium-line-height))}.mat-mdc-snack-bar-actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled).mat-unthemed{color:var(--mat-snack-bar-button-color, var(--mat-sys-inverse-primary))}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){--mat-text-button-state-layer-color:currentColor;--mat-text-button-ripple-color:currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}"],encapsulation:2})}return t})();function rn(){return new ue}var on=new J("mat-snack-bar-default-options",{providedIn:"root",factory:rn}),Et=(()=>{class t{_overlay=C(bi);_live=C(mi);_injector=C(Me);_breakpointObserver=C(_e);_parentSnackBar=C(t,{optional:!0,skipSelf:!0});_defaultConfig=C(on);_snackBarRefAtThisLevel=null;simpleSnackBarComponent=Oi;snackBarContainerComponent=an;handsetCssClass="mat-mdc-snack-bar-handset";get _openedSnackBarRef(){let e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}constructor(){}openFromComponent(e,n){return this._attach(e,n)}openFromTemplate(e,n){return this._attach(e,n)}open(e,n="",a){let s=ie(ie({},this._defaultConfig),a);return s.data={message:e,action:n},s.announcementMessage===e&&(s.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,s)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,n){let a=n&&n.viewContainerRef&&n.viewContainerRef.injector,s=Me.create({parent:a||this._injector,providers:[{provide:ue,useValue:n}]}),l=new wt(this.snackBarContainerComponent,n.viewContainerRef,s),x=e.attach(l);return x.instance.snackBarConfig=n,x.instance}_attach(e,n){let a=ie(ie(ie({},new ue),this._defaultConfig),n),s=this._createOverlay(a),l=this._attachSnackBarContainer(s,a),x=new ve(l,s);if(e instanceof jt){let T=new hi(e,null,{$implicit:a.data,snackBarRef:x});x.instance=l.attachTemplatePortal(T)}else{let T=this._createInjector(a,x),te=new wt(e,void 0,T),B=l.attachComponentPortal(te);x.instance=B.instance}return this._breakpointObserver.observe(st.HandsetPortrait).pipe(Ot(s.detachments())).subscribe(T=>{s.overlayElement.classList.toggle(this.handsetCssClass,T.matches)}),a.announcementMessage&&l._onAnnounce.subscribe(()=>{this._live.announce(a.announcementMessage,a.politeness)}),this._animateSnackBar(x,a),this._openedSnackBarRef=x,this._openedSnackBarRef}_animateSnackBar(e,n){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),n.announcementMessage&&this._live.clear()}),n.duration&&n.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(n.duration)),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter()}_createOverlay(e){let n=new vi;n.direction=e.direction;let a=this._overlay.position().global(),s=e.direction==="rtl",l=e.horizontalPosition==="left"||e.horizontalPosition==="start"&&!s||e.horizontalPosition==="end"&&s,x=!l&&e.horizontalPosition!=="center";return l?a.left("0"):x?a.right("0"):a.centerHorizontally(),e.verticalPosition==="top"?a.top("0"):a.bottom("0"),n.positionStrategy=a,this._overlay.create(n)}_createInjector(e,n){let a=e&&e.viewContainerRef&&e.viewContainerRef.injector;return Me.create({parent:a||this._injector,providers:[{provide:ve,useValue:n},{provide:Pi,useValue:e.data}]})}static \u0275fac=function(n){return new(n||t)};static \u0275prov=xe({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Fi=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=W({type:t});static \u0275inj=G({providers:[Et],imports:[Ci,_i,V,X,Oi,X]})}return t})();var mt=class t{asignacionIniciadaSubject=new Tt(!1);asignacionIniciada$=this.asignacionIniciadaSubject.asObservable();emitirAsignacionIniciada(){this.asignacionIniciadaSubject.next(!0)}reset(){this.asignacionIniciadaSubject.next(!1)}static \u0275fac=function(e){return new(e||t)};static \u0275prov=xe({token:t,factory:t.\u0275fac,providedIn:"root"})};var lt=class t{constructor(i,e,n){this.dialogRef=i;this.authService=e;this.rutaAsignacionService=n}patente="";despachos=[];ngOnInit(){let i=localStorage.getItem("nombre");this.authService.getDataDispatch().subscribe({next:e=>{this.despachos=e.filter(n=>n.chofer===i&&n.estado==="Despacho")},error:e=>{console.error("Error al obtener despachos:",e)}})}formatearPatente(){let i=this.patente.replace(/[^a-zA-Z0-9]/g,"").toUpperCase();i=i.slice(0,6);let e=i.slice(0,4),n=i.slice(4),a="";e.length>=2?(a+=e.slice(0,2),e.length>=4&&(a+="-"+e.slice(2,4))):a+=e,n.length>0&&(a+="-"+n),this.patente=a}confirmar(){if(!this.despachos||this.despachos.length===0){alert("Los despachos a\xFAn no est\xE1n cargados. Por favor espera unos segundos.");return}let i=/^[A-Z]{2}-[A-Z]{2}-\d{2}$/;if(!this.patente.trim()){alert("Por favor ingresa una patente v\xE1lida.");return}if(!i.test(this.patente.trim().toUpperCase())){alert("La patente ingresada no tiene un formato v\xE1lido. Ej: AB-CD-12");return}let e=new Date;if(localStorage.setItem("patente",this.patente),localStorage.setItem("fechaDespacho",e.toISOString()),localStorage.setItem("horaDespacho",e.toISOString()),this.despachos.length===0){alert("No existen despachos pendientes"),console.warn(' No hay despachos en estado "Despacho" para este chofer.');return}this.despachos.forEach(n=>{if(console.log(n),n.horaDespacho)return;let a={fechaDespacho:e,horaDespacho:e};this.authService.setDataDistpatch(n._id,a).subscribe({next:()=>{console.log(` Despacho ${n._id} actualizado`)},error:s=>{console.error(` Error al actualizar despacho ${n._id}:`,s)}})}),this.dialogRef.close(!0),this.rutaAsignacionService.emitirAsignacionIniciada()}cancelar(){this.dialogRef.close(null)}static \u0275fac=function(e){return new(e||t)(f(Le),f(D),f(mt))};static \u0275cmp=g({type:t,selectors:[["app-aceptar-ruta-modal"]],decls:14,vars:1,consts:[[2,"color","#ff9800"],["appearance","outline",1,"full-width"],["matInput","","type","text","maxlength","8","placeholder","AB-CD-12",3,"ngModelChange","input","ngModel"],["align","end"],["mat-button","","color","warn",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,n){e&1&&(o(0,"mat-dialog-content")(1,"h2",0),c(2,"Aceptar Ruta"),r(),o(3,"p"),c(4,"Ingresa la patente del veh\xEDculo:"),r(),o(5,"mat-form-field",1)(6,"mat-label"),c(7,"Patente"),r(),o(8,"input",2),Xt("ngModelChange",function(s){return Qt(n.patente,s)||(n.patente=s),s}),h("input",function(){return n.formatearPatente()}),r()()(),o(9,"mat-dialog-actions",3)(10,"button",4),h("click",function(){return n.cancelar()}),c(11,"Cancelar"),r(),o(12,"button",5),h("click",function(){return n.confirmar()}),c(13," Aceptar "),r()()),e&2&&(m(8),Wt("ngModel",n.patente))},dependencies:[O,se,oe,ce,ui,di,U,$e,Ue,L,z,j,me,V,R],styles:[".full-width[_ngcontent-%COMP%]{width:100%}"]})};function mn(t,i){t&1&&(o(0,"mat-error"),c(1," El nombre de usuario es obligatorio "),r())}function ln(t,i){t&1&&(o(0,"mat-error"),c(1," La contrase\xF1a es obligatoria "),r())}var ut=class t{constructor(i,e,n,a,s){this.fb=i;this.authService=e;this.router=n;this.snackBar=a;this.dialog=s;this.loginForm=this.fb.group({nombreUsuario:["",N.required],password:["",N.required]})}loginForm;hidePassword=!0;loading=!1;ngOnInit(){if(this.authService.isLoggedIn()){let i=this.authService.getRol();i==="chofer"?this.router.navigate(["/dispatch-view"]):i==="admin"?this.router.navigate(["/admin-view"]):this.router.navigate(["/available-view"])}}onSubmit(){if(this.loginForm.valid){this.loading=!0;let{nombreUsuario:i,password:e}=this.loginForm.value;this.authService.login(i,e).subscribe({next:n=>{this.loading=!1,this.authService.setSession(n.usuario),console.log("Respuesta del login:",n),this.authService.startAutoLogout();let a=n.usuario.rol,s=n.usuario.nombreUsuario,l=n.usuario.nombreUsuario;a==="chofer"?this.authService.getDataDispatch().subscribe({next:x=>{if(x.filter(B=>B.chofer===l&&B.estado==="Despacho").length===0){this.snackBar.open("No tienes despachos pendientes asignados.","Cerrar",{duration:4e3,panelClass:["snackbar-error"]}),this.authService.logout();return}this.dialog.open(lt,{disableClose:!0,data:{id:s}}).afterClosed().subscribe(B=>{B?this.router.navigate(["/dispatch-view"]):this.authService.logout()})},error:x=>{console.error("Error al verificar despachos:",x),this.snackBar.open("Error al verificar despachos. Intenta nuevamente.","Cerrar",{duration:4e3,panelClass:["snackbar-error"]}),this.authService.logout()}}):a==="admin"?this.router.navigate(["/admin-view"]):this.router.navigate(["/available-view"])},error:()=>{this.loading=!1,this.snackBar.open("Credenciales incorrectas.","Cerrar",{duration:3e3,panelClass:["snackbar-error"]})}})}}static \u0275fac=function(e){return new(e||t)(f(Re),f(D),f(F),f(Et),f(le))};static \u0275cmp=g({type:t,selectors:[["app-login"]],decls:23,vars:6,consts:[[1,"container"],[1,"login-container"],[1,"login-card"],[2,"text-align","center","margin-bottom","-30px"],["src","assets/vivipra.png","alt","Vivipra logo",2,"width","100px"],[1,"login-title"],[3,"formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","nombreUsuario","type","text","required","",2,"color","black"],[4,"ngIf"],["matInput","","formControlName","password","required","",2,"color","black",3,"type"],["mat-icon-button","","matSuffix","","type","button","tabindex","-1",3,"click"],["mat-raised-button","","type","submit",1,"full-width",3,"click","disabled"]],template:function(e,n){if(e&1&&(o(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"div",3),p(4,"img",4),r(),o(5,"h1",5),c(6,"Iniciar sesi\xF3n"),r(),o(7,"form",6)(8,"mat-form-field",7)(9,"mat-label"),c(10,"Nombre de Usuario"),r(),p(11,"input",8),d(12,mn,2,0,"mat-error",9),r(),o(13,"mat-form-field",7)(14,"mat-label"),c(15,"Contrase\xF1a"),r(),p(16,"input",10),o(17,"button",11),h("click",function(){return n.hidePassword=!n.hidePassword}),o(18,"mat-icon"),c(19),r()(),d(20,ln,2,0,"mat-error",9),r(),o(21,"button",12),h("click",function(){return n.onSubmit()}),c(22," Iniciar sesi\xF3n "),r()()()()()),e&2){let a,s;m(7),u("formGroup",n.loginForm),m(5),u("ngIf",(a=n.loginForm.get("nombreUsuario"))==null?null:a.hasError("required")),m(4),u("type",n.hidePassword?"password":"text"),m(3),I(n.hidePassword?"visibility_off":"visibility"),m(),u("ngIf",(s=n.loginForm.get("password"))==null?null:s.hasError("required")),m(),u("disabled",n.loginForm.invalid||n.loading)}},dependencies:[O,re,Ve,Pe,oe,ce,Te,pi,Oe,Fe,L,z,j,me,Be,fi,Z,Ii,Ai,V,R,je,K,H,Fi,U],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background:linear-gradient(to right,#f8f9fa,#e9ecef);padding:1rem}.login-card[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:2rem;border-radius:1.5rem;box-shadow:0 8px 20px #0000001a;background-color:#fff}@media (max-width: 480px){.login-card[_ngcontent-%COMP%]{padding:1.5rem 1rem;border-radius:1rem}}.login-title[_ngcontent-%COMP%]{text-align:center;font-size:1.8rem;font-weight:600;margin-bottom:1.5rem;color:#ff9800}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}"]})};var fe=(t=[])=>(i,e)=>{let n=C(D),a=C(F);if(!n.isLoggedIn())return a.navigate(["/login"]),!1;let s=n.getRol();return t.length>0&&!t.includes(s||"")?(a.navigate(["/unauthorized"]),!1):!0};var ft=class t{constructor(i){this.sanitizer=i}transform(i){return this.sanitizer.bypassSecurityTrustResourceUrl(i)}static \u0275fac=function(e){return new(e||t)(f(ri,16))};static \u0275pipe=zt({name:"safeUrl",type:t,pure:!0})};var he=class t{constructor(i){this.data=i}url="https://www.google.com/maps/embed/v1/place?key=AIzaSyA15X6cgX_IXgIqZRDnM_tjCJ1WGVStHuk&q=";static \u0275fac=function(e){return new(e||t)(f(He))};static \u0275cmp=g({type:t,selectors:[["app-modal-map"]],decls:8,vars:3,consts:[["mat-dialog-title",""],["width","100%","height","300","loading","lazy","allowfullscreen","",2,"border","0",3,"src"],["align","end"],["mat-button","","mat-dialog-close",""]],template:function(e,n){e&1&&(o(0,"h2",0),c(1,"Ubicaci\xF3n del despacho"),r(),o(2,"mat-dialog-content"),p(3,"iframe",1),ee(4,"safeUrl"),r(),o(5,"mat-dialog-actions",2)(6,"button",3),c(7,"Cerrar"),r()()),e&2&&(m(3),u("src",Ee(4,1,n.url+n.data.direccion),Nt))},dependencies:[U,xi,Mi,$e,Ue,ft],encapsulation:2})};var un=()=>[8,10,15,20];function fn(t,i){t&1&&(o(0,"th",26),c(1,"Folio"),r())}function hn(t,i){if(t&1&&(o(0,"td",27),c(1),r()),t&2){let e=i.$implicit;m(),b(" ",e.folio," ")}}function gn(t,i){t&1&&(o(0,"th",26),c(1,"Nombre cliente"),r())}function _n(t,i){if(t&1&&(o(0,"td",28),c(1),r()),t&2){let e=i.$implicit;m(),b(" ",e.nombreCliente," ")}}function vn(t,i){t&1&&(o(0,"th",26),c(1,"RUT cliente"),r())}function bn(t,i){if(t&1&&(o(0,"td",28),c(1),r()),t&2){let e=i.$implicit;m(),I(e.rutCliente)}}function Cn(t,i){t&1&&(o(0,"th",26),c(1,"Direccion"),r())}function xn(t,i){if(t&1&&(o(0,"td",28),c(1),r()),t&2){let e=i.$implicit;m(),b(" ",e.direccion," ")}}function Mn(t,i){t&1&&(o(0,"th",26),c(1,"Mapa"),r())}function wn(t,i){if(t&1){let e=P();o(0,"td",29)(1,"mat-icon",30),h("click",function(){let a=M(e).$implicit,s=y();return w(s.abrirMapa(a.direccion))}),c(2,"room"),r()()}}function yn(t,i){t&1&&(o(0,"th",26),c(1,"Entregar"),r())}function Sn(t,i){if(t&1){let e=P();o(0,"td",31)(1,"button",32),h("click",function(){let a=M(e).$implicit,s=y();return w(s.delivered(a))}),c(2," Entregar "),r()()}}function Dn(t,i){t&1&&p(0,"tr",33)}function En(t,i){t&1&&p(0,"tr",34)}function kn(t,i){if(t&1){let e=P();o(0,"div",37)(1,"div",38)(2,"strong"),c(3,"Folio:"),r(),c(4),r(),o(5,"div")(6,"strong"),c(7,"RUT Cliente:"),r(),c(8),r(),o(9,"div")(10,"strong"),c(11,"Cliente:"),r(),c(12),r(),o(13,"div")(14,"strong"),c(15,"Direccion:"),r(),c(16),r(),p(17,"hr"),o(18,"div",39)(19,"strong"),c(20," haz click en el icono para abrir el mapa "),r()(),o(21,"div",40)(22,"mat-icon",30),h("click",function(){M(e);let a=y().$implicit,s=y();return w(s.abrirMapa(a.direccion))}),c(23,"room"),r()(),o(24,"div")(25,"button",32),h("click",function(a){M(e);let s=y().$implicit;return y().delivered(s),w(a.stopPropagation())}),o(26,"strong"),c(27,"Entregado"),r()()()()}if(t&2){let e=y().$implicit;m(4),b(" ",e.folio," "),m(4),b(" ",e.rutCliente,""),m(4),b(" ",e.nombreCliente," "),m(4),b(" ",e.direccion," ")}}function An(t,i){if(t&1){let e=P();o(0,"div",35),h("click",function(){let a=M(e).$implicit;return w(a.expanded=!a.expanded)}),o(1,"div")(2,"strong"),c(3," Folio: "),r(),c(4),o(5,"strong"),c(6,"| Cliente:"),r(),c(7),r(),d(8,kn,28,4,"div",36),r()}if(t&2){let e=i.$implicit;m(4),b(" ",e.folio," "),m(3),b(" ",e.nombreCliente," "),m(),u("ngIf",e.expanded)}}var ht=class t{constructor(i,e,n,a){this.authService=i;this.breakpointObserver=e;this.router=n;this.dialog=a}displayedColumns=["folio","rutCliente","nombreCliente","Direccion","mapa","Entrega"];dataSource=new de([]);selection=new qe(!0,[]);expandedItem=null;isMobile=!1;paginator;sort;ngOnInit(){this.verificarRutaActiva(),setInterval(()=>{this.verificarRutaActiva()},1e4),this.breakpointObserver.observe([st.Handset]).subscribe(i=>{this.isMobile=i.matches}),this.getData()}verificarRutaActiva(){let i=localStorage.getItem("nombre");i&&this.authService.getDataDispatch().subscribe({next:e=>{e.filter(a=>a.chofer===i&&a.estado==="Despacho").length===0&&(alert("\xA1Has completado todos tus despachos! Tu sesi\xF3n ser\xE1 cerrada."),localStorage.clear(),this.router.navigate(["/login"]))},error:e=>{console.error("Error al verificar ruta activa:",e)}})}getData(){let i=this.authService.getRol(),e=this.authService.getNombreUsuario();this.authService.getDataDispatch().subscribe({next:n=>{let a=n;i==="chofer"&&(a=n.filter(s=>s.chofer?.toLowerCase()===e.toLowerCase()&&s.estado==="Despacho")),this.dataSource=new de(a),this.dataSource.sortingDataAccessor=(s,l)=>l==="FechaDocumento"?s._fechaHoraCompleta:s[l],this.dataSource.sort=this.sort,setTimeout(()=>{this.sort.active="FechaDocumento",this.sort.direction="desc",this.sort.sortChange.emit({active:"FechaDocumento",direction:"desc"})}),this.dataSource.paginator=this.paginator},error:n=>console.error("Error al obtener datos:",n)})}toggleExpansion(i){this.expandedItem=this.expandedItem===i?null:i}applyFilter(i){let e=i.target.value;this.dataSource.filter=e.trim().toLowerCase()}abrirMapa(i){this.dialog.open(he,{width:"600px",data:{direccion:i}})}delivered(i){let e={state:{despacho:i}};this.router.navigate(["/delivered-form"],e)}logout(){localStorage.removeItem("token"),localStorage.removeItem("rol"),localStorage.removeItem("userId"),localStorage.clear(),this.router.navigate(["/login"])}static \u0275fac=function(e){return new(e||t)(f(D),f(_e),f(F),f(le))};static \u0275cmp=g({type:t,selectors:[["app-dispatch-view"]],viewQuery:function(e,n){if(e&1&&(E(Y,5),E(pe,5)),e&2){let a;k(a=A())&&(n.paginator=a.first),k(a=A())&&(n.sort=a.first)}},decls:39,vars:7,consts:[["mat-button","","color","warn",3,"click"],[1,"mat-elevation-z4","responsive-container"],[1,"search-bar-container"],["appearance","outline",1,"search-field"],["matPrefix",""],["matInput","","placeholder","Buscar",3,"keyup"],[2,"display","flex","justify-content","flex-end","width","100%","align-items","center","padding","0px 20px"],["src","assets/vivipra.png","alt","vivipra",2,"width","100px"],[1,"desktop-view","table-container"],["mat-table","","matSort","",1,"mat-table",3,"dataSource"],["matColumnDef","folio"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","id","folio",4,"matCellDef"],["matColumnDef","nombreCliente"],["mat-cell","",4,"matCellDef"],["matColumnDef","rutCliente"],["matColumnDef","Direccion"],["matColumnDef","mapa"],["mat-cell","","style","text-align: center",4,"matCellDef"],["matColumnDef","Entrega"],["mat-cell","","style","padding-left: 90px",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSize","pageSizeOptions"],[1,"mobile-list"],["class","mobile-card",3,"click",4,"ngFor","ngForOf"],["mat-header-cell",""],["mat-cell","","id","folio"],["mat-cell",""],["mat-cell","",2,"text-align","center"],[2,"cursor","pointer",3,"click"],["mat-cell","",2,"padding-left","90px"],["mat-button","",1,"dButton",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mobile-card",3,"click"],["class","mobile-card-details",4,"ngIf"],[1,"mobile-card-details"],["id","folio"],[2,"text-align","center","margin-bottom","1rem"],[2,"text-align","center"]],template:function(e,n){e&1&&(o(0,"button",0),h("click",function(){return n.logout()}),o(1,"mat-icon"),c(2,"logout"),r(),c(3,` Cerrar sesi\xF3n
`),r(),o(4,"div",1)(5,"div",2)(6,"div")(7,"mat-form-field",3)(8,"mat-icon",4),c(9,"search"),r(),o(10,"input",5),h("keyup",function(s){return n.applyFilter(s)}),r()()(),o(11,"div",6)(12,"div"),p(13,"img",7),r()()(),o(14,"div",8)(15,"table",9),_(16,10),d(17,fn,2,0,"th",11)(18,hn,2,1,"td",12),v(),_(19,13),d(20,gn,2,0,"th",11)(21,_n,2,1,"td",14),v(),_(22,15),d(23,vn,2,0,"th",11)(24,bn,2,1,"td",14),v(),_(25,16),d(26,Cn,2,0,"th",11)(27,xn,2,1,"td",14),v(),_(28,17),d(29,Mn,2,0,"th",11)(30,wn,3,0,"td",18),v(),_(31,19),d(32,yn,2,0,"th",11)(33,Sn,3,0,"td",20),v(),d(34,Dn,1,0,"tr",21)(35,En,1,0,"tr",22),r(),p(36,"mat-paginator",23),r(),o(37,"div",24),d(38,An,9,3,"div",25),r()()),e&2&&(m(15),u("dataSource",n.dataSource),m(19),u("matHeaderRowDef",n.displayedColumns),m(),u("matRowDefColumns",n.displayedColumns),m(),u("pageSize",8)("pageSizeOptions",ae(6,un)),m(2),u("ngForOf",n.dataSource.filteredData))},dependencies:[O,Ie,re,it,Ge,Qe,Ye,Xe,We,Je,Ze,Ke,et,tt,V,R,K,H,se,Z,j,Ne,L,z,nt,at,Y,ze,pe,rt,Ti,U],styles:['@charset "UTF-8";.search-bar-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin:0 auto;padding:0 30px}.search-field[_ngcontent-%COMP%]{width:100%;max-width:500px;background:#fff;border-radius:12px}[_nghost-%COMP%]     .mat-form-field-outline{border-color:#ccc;border-radius:12px}[_nghost-%COMP%]     .mat-form-field-outline-thick{border-color:#ff9800!important}[_nghost-%COMP%]     .mat-input-element{color:#333}[_nghost-%COMP%]     .mat-form-field-label{color:#888}[_nghost-%COMP%]     .mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick{border-color:#ff9800}[_nghost-%COMP%]     .mat-icon{color:#ff9800}[_nghost-%COMP%]     .mat-button{background-color:#ff9800!important;color:#fff!important}table[_ngcontent-%COMP%]{width:100%;border-radius:.5rem .5rem 0 0;overflow:hidden;border-collapse:collapse}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#212121;color:#fff;font-weight:600;text-align:center;padding:.75rem;font-size:15px;letter-spacing:.5px;text-transform:uppercase}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.7rem;font-size:.95rem;color:#000;text-align:center;justify-content:center;align-items:center}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n)   td[_ngcontent-%COMP%]{background-color:#f5f5f5}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd)   td[_ngcontent-%COMP%]{background-color:#fff}h2[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#333;text-transform:uppercase;border-left:6px solid #ff9800;padding-left:10px;margin-bottom:.5rem}h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#424242;margin-top:1rem;margin-bottom:.5rem;padding-left:10px;border-left:4px solid #ffb74d}[_nghost-%COMP%]     button{margin-right:5rem}.desktop-view[_ngcontent-%COMP%]{padding:0 30px}@media (max-width: 600px){.tabla-container[_ngcontent-%COMP%]{padding:.5rem}table[_ngcontent-%COMP%]{font-size:.85rem}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem}table[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem}}.dButton[_ngcontent-%COMP%]{color:#fff!important;background-color:#ff9800!important}.mobile-list[_ngcontent-%COMP%]{display:none}@media (max-width: 1024px){.desktop-view[_ngcontent-%COMP%]{display:none!important;padding:none;margin:none;overflow:hidden}.mobile-list[_ngcontent-%COMP%]{display:block}.mobile-card[_ngcontent-%COMP%]{background:#fff;border-radius:10px;padding:1rem;margin-bottom:1rem;box-shadow:0 2px 5px #0000001a;border-left:4px solid #ff9800;transition:box-shadow .3s}.mobile-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 10px #00000026}.mobile-card-header[_ngcontent-%COMP%]{font-weight:700;font-size:1rem;color:#333}.mobile-card-details[_ngcontent-%COMP%]{margin-top:.75rem;font-size:.9rem;color:#555}.mobile-card-details[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:4px}.search-bar-container[_ngcontent-%COMP%]{padding:0}.dButton[_ngcontent-%COMP%]{margin-top:.6rem}}']})};function Vi(t){let i=t.value;if(!i)return null;if(!/^\d{1,2}\.\d{3}\.\d{3}-[\dkK]$/.test(i))return{rutInvalido:!0};let[n,a]=i.split("-"),s=n.replace(/\./g,""),l=0,x=2;for(let B=s.length-1;B>=0;B--)l+=parseInt(s[B],10)*x,x=x===7?2:x+1;let T=l%11,te=T===1?"K":T===0?"0":(11-T).toString();return a.toUpperCase()!==te?{rutInvalido:!0}:null}var In=["signaturePad"];function Tn(t,i){t&1&&(o(0,"mat-error"),c(1," RUT no v\xE1lido. Ejemplo: 12.345.678-K "),r())}var gt=class t{constructor(i,e,n){this.fb=i;this.authService=e;this.router=n}deliveredForm;signaturePadElement;ctx;drawing=!1;hasDrawn=!1;ngOnInit(){let i=history.state.despacho,e=i._id;this.deliveredForm=this.fb.group({folio:[i?.folio||"",N.required],rutCliente:[i?.rutCliente||"",N.required],nombreCliente:[i?.nombreCliente||"",N.required],direccion:[i?.direccion||"",N.required],comentario:[i?.comentarioDespacho||""],rutEntrega:["",[N.required,Vi]],nombreEntrega:["",N.required],comentarioEntrega:[""]})}ngAfterViewInit(){let i=this.signaturePadElement.nativeElement;this.ctx=i.getContext("2d"),i.width=i.offsetWidth,i.height=120,this.ctx.strokeStyle="#ff9800",this.ctx.lineWidth=2,this.ctx.lineCap="round",i.style.touchAction="none",i.addEventListener("mousedown",this.startDrawing.bind(this)),i.addEventListener("mousemove",this.draw.bind(this)),i.addEventListener("mouseup",this.finishDrawing.bind(this)),i.addEventListener("mouseleave",this.finishDrawing.bind(this)),i.addEventListener("touchstart",this.startDrawing.bind(this),{passive:!1}),i.addEventListener("touchmove",this.draw.bind(this),{passive:!1}),i.addEventListener("touchend",this.finishDrawing.bind(this)),this.drawGuideText()}getPosition(i){let e=this.signaturePadElement.nativeElement.getBoundingClientRect(),n,a;return i instanceof TouchEvent?(n=i.touches[0]?.clientX??i.changedTouches[0]?.clientX,a=i.touches[0]?.clientY??i.changedTouches[0]?.clientY):(n=i.clientX,a=i.clientY),{x:n-e.left,y:a-e.top}}startDrawing(i){i.preventDefault(),this.drawing=!0,this.hasDrawn=!0;let{x:e,y:n}=this.getPosition(i);this.ctx.beginPath(),this.ctx.moveTo(e,n)}draw(i){if(!this.drawing)return;i.preventDefault();let{x:e,y:n}=this.getPosition(i);this.ctx.lineTo(e,n),this.ctx.stroke()}finishDrawing(){this.drawing=!1}clearSignature(){let i=this.signaturePadElement.nativeElement;this.ctx.clearRect(0,0,i.width,i.height),this.drawGuideText(),this.hasDrawn=!1}drawGuideText(){this.ctx.font="16px sans-serif",this.ctx.fillStyle="#999",this.ctx.textAlign="center",this.ctx.fillText("Firme aqu\xED",this.signaturePadElement.nativeElement.width/2,70)}getSignatureDataURL(){return this.signaturePadElement.nativeElement.toDataURL()}onSubmit(){let{_id:i}=history.state.despacho;if(this.deliveredForm.invalid){alert("Por favor, completa todos los campos obligatorios.");return}if(!this.hasDrawn){alert("Por favor, firme antes de enviar.");return}let e=this.deliveredForm.getRawValue(),{rutEntrega:n,nombreEntrega:a,comentarioEntrega:s}=e,l=this.getSignatureDataURL(),x=localStorage.getItem("patente")||"",T={estado:"Entregado",rutEntrega:n,nombreEntrega:a,comentarioEntrega:s,imagenEntrega:l,patente:x};this.authService.setDataDispatchDelivered(i,T).subscribe({next:()=>{alert("Entrega registrada con \xE9xito"),this.deliveredForm.reset(),this.clearSignature(),this.router.navigate(["/despachos"])},error:te=>{console.error("Error al guardar la entrega:",te),alert("Error al guardar la entrega")}})}logout(){localStorage.removeItem("token"),localStorage.removeItem("rol"),localStorage.removeItem("userId"),localStorage.clear(),this.router.navigate(["/login"])}formatearRutEntrega(){let i=this.deliveredForm.get("rutEntrega")?.value||"";if(i=i.replace(/[^0-9kK]/g,"").toUpperCase(),i=i.slice(0,9),i.length<2)return;let e=i.slice(0,-1),n=i.slice(-1),a="",s=e;for(;s.length>3;)a="."+s.slice(-3)+a,s=s.slice(0,-3);a=s+a;let l=`${a}-${n}`;this.deliveredForm.get("rutEntrega")?.setValue(l,{emitEvent:!1})}static \u0275fac=function(e){return new(e||t)(f(Re),f(D),f(F))};static \u0275cmp=g({type:t,selectors:[["app-delivered-form"]],viewQuery:function(e,n){if(e&1&&E(In,5),e&2){let a;k(a=A())&&(n.signaturePadElement=a.first)}},decls:55,vars:2,consts:[["signaturePad",""],["mat-button","","color","warn",3,"click"],[1,"wrapper"],[1,"form-container",3,"ngSubmit","formGroup"],[2,"display","flex","justify-content","center","margin-bottom","0px"],["src","assets/vivipra.png","alt","vivipra",2,"width","90px"],[2,"text-align","center","margin-top","-25px"],["appearance","outline",1,"full-width"],["readonly","","matInput","","formControlName","folio"],["readonly","","matInput","","formControlName","rutCliente"],["readonly","","matInput","","formControlName","nombreCliente"],["readonly","","matInput","","formControlName","direccion"],["readonly","","matInput","","formControlName","comentario"],[2,"text-align","center"],["matInput","","formControlName","rutEntrega","placeholder","Ej: 12.345.678-9",3,"input"],[4,"ngIf"],["matInput","","formControlName","nombreEntrega"],["matInput","","formControlName","comentarioEntrega"],[1,"signature-container"],[1,"signature-pad"],[1,"buttons"],["type","button",1,"btn-action",3,"click"],["type","submit",1,"btn-action"]],template:function(e,n){if(e&1){let a=P();o(0,"button",1),h("click",function(){return M(a),w(n.logout())}),o(1,"mat-icon"),c(2,"logout"),r(),c(3,` Cerrar sesi\xF3n
`),r(),o(4,"div",2)(5,"form",3),h("ngSubmit",function(){return M(a),w(n.onSubmit())}),o(6,"div",4),p(7,"img",5),r(),o(8,"h3",6),c(9,"Datos de la factura"),r(),o(10,"mat-form-field",7)(11,"mat-label"),c(12,"Folio"),r(),p(13,"input",8),r(),o(14,"mat-form-field",7)(15,"mat-label"),c(16,"RUT Cliente"),r(),p(17,"input",9),r(),o(18,"mat-form-field",7)(19,"mat-label"),c(20,"Nombre Cliente"),r(),p(21,"input",10),r(),o(22,"mat-form-field",7)(23,"mat-label"),c(24,"Direcci\xF3n"),r(),p(25,"input",11),r(),o(26,"mat-form-field",7)(27,"mat-label"),c(28,"Comentarios"),r(),p(29,"textarea",12),r(),o(30,"h3",13),c(31,"Datos de entrega"),r(),o(32,"mat-form-field",7)(33,"mat-label"),c(34,"RUT"),r(),o(35,"input",14),h("input",function(){return M(a),w(n.formatearRutEntrega())}),r(),d(36,Tn,2,0,"mat-error",15),r(),o(37,"mat-form-field",7)(38,"mat-label"),c(39,"Nombre"),r(),p(40,"input",16),r(),o(41,"mat-form-field",7)(42,"mat-label"),c(43,"Comentario"),r(),p(44,"textarea",17),r(),o(45,"div",18)(46,"mat-label"),c(47,"Firma"),r(),p(48,"canvas",19,0),r(),o(50,"div",20)(51,"button",21),h("click",function(){return M(a),w(n.clearSignature())}),c(52," Limpiar "),r(),o(53,"button",22),c(54,"Guardar"),r()()()()}if(e&2){let a;m(5),u("formGroup",n.deliveredForm),m(31),u("ngIf",(a=n.deliveredForm.get("rutEntrega"))==null?null:a.hasError("rutInvalido"))}},dependencies:[O,re,Ve,Pe,oe,ce,Te,Oe,Fe,Z,j,me,Be,L,z,V,R,H],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;padding:32px 16px;box-sizing:border-box;background-color:#f3f4f6;min-height:100vh}.form-container[_ngcontent-%COMP%]{flex:1 1 100%;max-width:480px;display:flex;flex-direction:column;gap:20px;padding:24px;background-color:#fff;border-radius:16px;box-shadow:0 8px 24px #00000014;color:#333;box-sizing:border-box;transition:box-shadow .3s ease}.form-container[_ngcontent-%COMP%]:hover{box-shadow:0 12px 32px #0000001f}.full-width[_ngcontent-%COMP%]{width:100%}h3[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600;color:#444;border-bottom:1px solid #e0e0e0;padding-bottom:.3rem;margin-bottom:.5rem}.signature-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.signature-pad[_ngcontent-%COMP%]{border:2px dashed #c4c4c4;background-color:#fafafa;width:100%;height:120px;border-radius:8px;touch-action:none}.buttons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:12px;justify-content:space-between}.btn-action[_ngcontent-%COMP%]{background-color:#ffa726!important;color:#fff!important;border:none;border-radius:12px;padding:10px 24px;font-weight:600;font-size:.95rem;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 8px #00000014}.btn-action[_ngcontent-%COMP%]:hover{transform:scale(1.05)}  mat-form-field input,   mat-form-field textarea{color:#222!important}  mat-form-field mat-label{color:#666!important}@media (max-width: 768px){.form-container[_ngcontent-%COMP%]{padding:16px}.buttons[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.btn-action[_ngcontent-%COMP%]{width:100%;text-align:center}}"]})};var _t=class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=g({type:t,selectors:[["app-unauthorized-component"]],decls:7,vars:0,consts:[[1,"unauthorized-container"],["mat-raised-button","","color","primary","routerLink","/login"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"h1"),c(2,"401 - No autorizado"),r(),o(3,"p"),c(4,"No tienes permisos para acceder a esta secci\xF3n."),r(),o(5,"button",1),c(6," Volver al inicio de sesi\xF3n "),r()())},styles:[".unauthorized-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;text-align:center;padding:16px}h1[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:16px}p[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:32px}button[_ngcontent-%COMP%]{font-size:1rem}"]})};var vt=class t{constructor(i,e){this.dialogRef=i;this.data=e}static \u0275fac=function(e){return new(e||t)(f(Le),f(He))};static \u0275cmp=g({type:t,selectors:[["app-firma-modal"]],decls:8,vars:1,consts:[[1,"modal-container"],[1,"modal-header"],["mat-icon-button","","aria-label","Cerrar",3,"click"],["alt","Firma",1,"firma-img",3,"src"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"h2"),c(3,"Firma del despacho"),r(),o(4,"button",2),h("click",function(){return n.dialogRef.close()}),o(5,"mat-icon"),c(6,"close"),r()()(),p(7,"img",3),r()),e&2&&(m(7),u("src",n.data.imagen,Bt))},dependencies:[O,U,K,H],styles:[".modal-container[_ngcontent-%COMP%]{text-align:center;padding:20px;color:#ff9800}.firma-img[_ngcontent-%COMP%]{max-width:100%;max-height:70vh;border:1px solid #ccc;margin-top:10px}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}button[mat-icon-button][_ngcontent-%COMP%]{color:#555}"]})};var Pn=()=>[8,10,15,20],Bi=()=>["folio","nombreCliente","rutCliente","acciones"];function On(t,i){t&1&&(o(0,"th",33),c(1,"Folio"),r())}function Fn(t,i){if(t&1&&(o(0,"td",34),c(1),r()),t&2){let e=i.$implicit;m(),I(e.folio)}}function Rn(t,i){t&1&&(o(0,"th",33),c(1,"RUT Cliente"),r())}function Vn(t,i){if(t&1&&(o(0,"td",34),c(1),r()),t&2){let e=i.$implicit;m(),I(e.rutCliente)}}function Bn(t,i){t&1&&(o(0,"th",33),c(1,"Nombre Cliente"),r())}function Nn(t,i){if(t&1&&(o(0,"td",34),c(1),r()),t&2){let e=i.$implicit;m(),b(" ",e.nombreCliente," ")}}function jn(t,i){t&1&&(o(0,"th",35),c(1,"Tipo entrega"),r())}function zn(t,i){if(t&1&&(o(0,"td",34),c(1),r()),t&2){let e=i.$implicit;m(),I(e.tipoEntrega)}}function Ln(t,i){t&1&&(o(0,"th",33),c(1,"rut entrega"),r())}function Hn(t,i){if(t&1&&(o(0,"td",34),c(1),r()),t&2){let e=i.$implicit;m(),I(e.rutEntrega)}}function Un(t,i){t&1&&(o(0,"th",33),c(1,"Nombre entrega"),r())}function $n(t,i){if(t&1&&(o(0,"td",34),c(1),r()),t&2){let e=i.$implicit;m(),b(" ",e.nombreEntrega," ")}}function qn(t,i){t&1&&(o(0,"th",33),c(1,"Chofer"),r())}function Gn(t,i){if(t&1&&(o(0,"td",34),c(1),r()),t&2){let e=i.$implicit;m(),I(e.chofer)}}function Wn(t,i){t&1&&(o(0,"th",33),c(1,"Patente"),r())}function Qn(t,i){if(t&1&&(o(0,"td",34),c(1),ee(2,"uppercase"),r()),t&2){let e=i.$implicit;m(),b(" ",Ee(2,1,e.patente)," ")}}function Xn(t,i){t&1&&(o(0,"th",33),c(1,"Asignado por"),r())}function Zn(t,i){if(t&1&&(o(0,"td",34),c(1),r()),t&2){let e=i.$implicit;m(),I(e.asignadoPor)}}function Kn(t,i){t&1&&(o(0,"th",33),c(1,"Fecha asignaci\xF3n"),r())}function Yn(t,i){if(t&1&&(o(0,"td",34)(1,"i"),c(2,"Fecha:"),r(),c(3),ee(4,"date"),o(5,"i"),c(6,"Hora:"),r(),c(7),r()),t&2){let e=i.$implicit;m(3),b(" ",ke(4,2,e.fechaAsignacion,"dd/MM/yyyy")," "),m(4),b(" ",e.horaAsignacion?e.horaAsignacion:"Sin registro"," ")}}function Jn(t,i){t&1&&(o(0,"th",33),c(1,"Fecha despacho"),r())}function ea(t,i){if(t&1&&(o(0,"td",34)(1,"i"),c(2,"Fecha:"),r(),c(3),ee(4,"date"),o(5,"i"),c(6,"Hora:"),r(),c(7),r()),t&2){let e=i.$implicit;m(3),b(" ",ke(4,2,e.fechaDespacho,"dd/MM/yyyy HH:mm")," "),m(4),b(" ",e.horaDespacho?e.horaDespacho:"Sin registro"," ")}}function ta(t,i){t&1&&(o(0,"th",33),c(1,"Fecha entrega"),r())}function ia(t,i){if(t&1&&(o(0,"td",34)(1,"i"),c(2,"Fecha:"),r(),c(3),ee(4,"date"),o(5,"i"),c(6,"Hora:"),r(),c(7),r()),t&2){let e=i.$implicit;m(3),b(" ",ke(4,2,e.fechaEntrega,"dd/MM/yyyy")," "),m(4),b(" ",e.horaEntrega?e.horaEntrega:"No hay"," ")}}function na(t,i){t&1&&(o(0,"th",33),c(1,"Tiempo"),r())}function aa(t,i){if(t&1&&(o(0,"td",34),c(1),r()),t&2){let e=i.$implicit;m(),b(" ",e.tiempoTranscurrido," ")}}function ra(t,i){t&1&&(o(0,"th",33),c(1,"Comentario"),r())}function oa(t,i){if(t&1&&(o(0,"td",34),c(1),r()),t&2){let e=i.$implicit;m(),b(" ",e.comentarioEntrega," ")}}function ca(t,i){t&1&&(o(0,"th",33),c(1,"Firma"),r())}function sa(t,i){if(t&1){let e=P();o(0,"td",34)(1,"button",36),h("click",function(){let a=M(e).$implicit,s=y();return w(s.abrirModalFirma(a.imagenEntrega))}),c(2," Ver firma "),r()()}}function ma(t,i){t&1&&p(0,"tr",37)}function la(t,i){t&1&&p(0,"tr",38)}function da(t,i){t&1&&(o(0,"th",33),c(1,"Folio"),r())}function pa(t,i){if(t&1&&(o(0,"td",34),c(1),r()),t&2){let e=i.$implicit;m(),I(e.folio)}}function ua(t,i){t&1&&(o(0,"th",33),c(1,"Cliente"),r())}function fa(t,i){if(t&1&&(o(0,"td",34),c(1),r()),t&2){let e=i.$implicit;m(),b(" ",e.nombreCliente," ")}}function ha(t,i){t&1&&(o(0,"th",33),c(1,"RUT cliente"),r())}function ga(t,i){if(t&1&&(o(0,"td",34),c(1),r()),t&2){let e=i.$implicit;m(),I(e.rutCliente)}}function _a(t,i){t&1&&(o(0,"th",33),c(1,"Acciones"),r())}function va(t,i){if(t&1){let e=P();o(0,"td",34)(1,"button",42),h("click",function(){let a=M(e).$implicit,s=y(2);return w(s.eliminarDespacho(a._id))}),o(2,"mat-icon"),c(3,"delete"),r()()()}}function ba(t,i){t&1&&p(0,"tr",37)}function Ca(t,i){t&1&&p(0,"tr",38)}function xa(t,i){if(t&1&&(o(0,"div",39)(1,"h3"),c(2),r(),o(3,"table",40),_(4,11),d(5,da,2,0,"th",12)(6,pa,2,1,"td",13),v(),_(7,15),d(8,ua,2,0,"th",12)(9,fa,2,1,"td",13),v(),_(10,14),d(11,ha,2,0,"th",12)(12,ga,2,1,"td",13),v(),_(13,41),d(14,_a,2,0,"th",12)(15,va,4,0,"td",13),v(),d(16,ba,1,0,"tr",29)(17,Ca,1,0,"tr",30),r()()),t&2){let e=i.$implicit;m(2),b("Chofer: ",e.chofer,""),m(),u("dataSource",e.despachos),m(13),u("matHeaderRowDef",ae(4,Bi)),m(),u("matRowDefColumns",ae(5,Bi))}}var bt=class t{constructor(i,e,n){this.authService=i;this.dialog=e;this.router=n}displayedColumns=["folio","rutCliente","nombreCliente","tipoEntrega","rutEntrega","nombreEntrega","chofer","patente","asignadoPor","fechaAsignacion","fechaDespacho","fechaEntrega","tiempoTranscurrido","comentarioEntrega","imagenEntrega"];dataSource=new de([]);selection=new qe(!0,[]);despachosExistentes=new Set;paginator;sort;choferesConDespachos=[];ngOnInit(){this.chargeData(),this.chargeDespachosActivos()}combinarFechaHora(i,e){if(!i||!e||e.toLowerCase().includes("sin")||e.trim()==="")return null;let n=`${i}T${e}`,a=new Date(n);return isNaN(a.getTime())?null:a}calcularDiferencia(i,e){if(!i||!e)return"---";let n=e.getTime()-i.getTime();if(isNaN(n)||n<0)return"---";let a=Math.floor(n/6e4),s=Math.floor(a/60),l=a%60;return`${s}h ${l}m`}chargeData(){this.authService.getDataDispatch().subscribe({next:i=>{let e=i.filter(n=>n.estado==="Entregado");e.forEach(n=>{let a=n.fechaAsignacion?new Date(n.fechaAsignacion):null,s=n.fechaEntrega?new Date(n.fechaEntrega):null;n.tiempoTranscurrido=this.calcularDiferencia(a,s)}),this.dataSource=new de(e),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator},error:i=>console.error("Error al obtener datos desde Mongo:",i)})}chargeDespachosActivos(){return It(this,null,function*(){try{let[i,e]=yield Promise.all([this.authService.getDataDispatch().toPromise(),this.authService.getDataUser().toPromise()]),n=e.filter(l=>l.rol==="chofer").map(l=>l.nombreUsuario),a=i.filter(l=>l.estado==="Despacho"&&n.includes(l.chofer)),s={};a.forEach(l=>{s[l.chofer]||(s[l.chofer]=[]),s[l.chofer].push(l)}),this.choferesConDespachos=Object.entries(s).map(([l,x])=>({chofer:l,despachos:x}))}catch(i){console.error("Error al cargar despachos activos o usuarios:",i)}})}trackByFolio(i,e){return e.folio}applyFilter(i){let e=i.target.value;this.dataSource.filter=e.trim().toLowerCase()}abrirModalFirma(i){this.dialog.open(vt,{data:{imagen:i},width:"600px",maxHeight:"90vh"})}logout(){localStorage.clear(),this.router.navigate(["/login"])}eliminarDespacho(i){this.authService.deleteDispatch(i).subscribe({next:()=>{this.chargeData(),this.chargeDespachosActivos()},error:e=>console.error("Error al eliminar despacho:",e)})}static \u0275fac=function(e){return new(e||t)(f(D),f(le),f(F))};static \u0275cmp=g({type:t,selectors:[["app-admin-view"]],viewQuery:function(e,n){if(e&1&&(E(Y,5),E(pe,5)),e&2){let a;k(a=A())&&(n.paginator=a.first),k(a=A())&&(n.sort=a.first)}},decls:69,vars:8,consts:[["mat-button","","color","warn",3,"click"],[1,"mat-elevation-z4",2,"overflow-x","auto"],[1,"search-bar-container"],["appearance","outline",1,"search-field"],["matPrefix",""],["matInput","","placeholder","Buscar",3,"keyup"],[2,"display","flex","justify-content","flex-end","width","100%","align-items","center","padding","0px 30px"],["src","assets/vivipra.png","alt","vivipra",2,"width","100px"],[1,"desktop-view"],[2,"margin-top","40px"],["mat-table","","matSort","","matSortActive","folio","matSortDirection","asc","matSortDisableClear","",1,"mat-table",3,"dataSource","trackBy"],["matColumnDef","folio"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","rutCliente"],["matColumnDef","nombreCliente"],["matColumnDef","tipoEntrega"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","rutEntrega"],["matColumnDef","nombreEntrega"],["matColumnDef","chofer"],["matColumnDef","patente"],["matColumnDef","asignadoPor"],["matColumnDef","fechaAsignacion"],["matColumnDef","fechaDespacho"],["matColumnDef","fechaEntrega"],["matColumnDef","tiempoTranscurrido"],["matColumnDef","comentarioEntrega"],["matColumnDef","imagenEntrega"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSize","pageSizeOptions"],["style","margin-bottom: 40px",4,"ngFor","ngForOf"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","","mat-sort-header",""],["mat-button","","color","primary",3,"click"],["mat-header-row",""],["mat-row",""],[2,"margin-bottom","40px"],["mat-table","",1,"mat-elevation-z2",2,"width","100%",3,"dataSource"],["matColumnDef","acciones"],["mat-icon-button","","color","warn",3,"click"]],template:function(e,n){e&1&&(o(0,"button",0),h("click",function(){return n.logout()}),o(1,"mat-icon"),c(2,"logout"),r(),c(3,` Cerrar sesi\xF3n
`),r(),o(4,"div",1)(5,"div",2)(6,"div")(7,"mat-form-field",3)(8,"mat-icon",4),c(9,"search"),r(),o(10,"input",5),h("keyup",function(s){return n.applyFilter(s)}),r()()(),o(11,"div",6),p(12,"img",7),r()(),o(13,"div",8)(14,"h2",9),c(15,"Despachos finalizados"),r(),p(16,"br"),o(17,"table",10),_(18,11),d(19,On,2,0,"th",12)(20,Fn,2,1,"td",13),v(),_(21,14),d(22,Rn,2,0,"th",12)(23,Vn,2,1,"td",13),v(),_(24,15),d(25,Bn,2,0,"th",12)(26,Nn,2,1,"td",13),v(),_(27,16),d(28,jn,2,0,"th",17)(29,zn,2,1,"td",13),v(),_(30,18),d(31,Ln,2,0,"th",12)(32,Hn,2,1,"td",13),v(),_(33,19),d(34,Un,2,0,"th",12)(35,$n,2,1,"td",13),v(),_(36,20),d(37,qn,2,0,"th",12)(38,Gn,2,1,"td",13),v(),_(39,21),d(40,Wn,2,0,"th",12)(41,Qn,3,3,"td",13),v(),_(42,22),d(43,Xn,2,0,"th",12)(44,Zn,2,1,"td",13),v(),_(45,23),d(46,Kn,2,0,"th",12)(47,Yn,8,5,"td",13),v(),_(48,24),d(49,Jn,2,0,"th",12)(50,ea,8,5,"td",13),v(),_(51,25),d(52,ta,2,0,"th",12)(53,ia,8,5,"td",13),v(),_(54,26),d(55,na,2,0,"th",12)(56,aa,2,1,"td",13),v(),_(57,27),d(58,ra,2,0,"th",12)(59,oa,2,1,"td",13),v(),_(60,28),d(61,ca,2,0,"th",12)(62,sa,3,0,"td",13),v(),d(63,ma,1,0,"tr",29)(64,la,1,0,"tr",30),r(),p(65,"mat-paginator",31),o(66,"h2",9),c(67,"Despachos en curso por chofer"),r(),d(68,xa,18,6,"div",32),r()()),e&2&&(m(17),u("dataSource",n.dataSource)("trackBy",n.trackByFolio),m(46),u("matHeaderRowDef",n.displayedColumns),m(),u("matRowDefColumns",n.displayedColumns),m(),u("pageSize",8)("pageSizeOptions",ae(7,Pn)),m(3),u("ngForOf",n.choferesConDespachos))},dependencies:[O,Ie,ti,ii,it,Ge,Qe,Ye,Xe,We,Je,Ze,Ke,et,tt,V,R,je,K,H,se,Z,j,Ne,L,z,nt,at,Y,ze,pe,rt,yi,Si,wi],styles:[".search-bar-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin:0 auto;padding:0 30px}.search-field[_ngcontent-%COMP%]{width:100%;max-width:500px;background:#fff;border-radius:12px}[_nghost-%COMP%]     .mat-form-field-outline{border-color:#ccc;border-radius:12px}[_nghost-%COMP%]     .mat-form-field-outline-thick{border-color:#ff9800!important}[_nghost-%COMP%]     .mat-input-element{color:#333}[_nghost-%COMP%]     .mat-form-field-label{color:#888}[_nghost-%COMP%]     .mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick{border-color:#ff9800}[_nghost-%COMP%]     .mat-icon{color:#ff9800}[_nghost-%COMP%]     .mat-button{background-color:#ff9800!important;color:#fff!important}table[_ngcontent-%COMP%]{width:100%;border-radius:.5rem .5rem 0 0;overflow:hidden;border-collapse:collapse}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#212121;color:#fff;font-weight:600;text-align:center;padding:.75rem;font-size:15px;letter-spacing:.5px;text-transform:uppercase}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.7rem;font-size:.95rem;color:#000;text-align:center;justify-content:center;align-items:center}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n)   td[_ngcontent-%COMP%]{background-color:#f5f5f5}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd)   td[_ngcontent-%COMP%]{background-color:#fff}h2[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#333;text-transform:uppercase;border-left:6px solid #ff9800;padding-left:10px;margin-bottom:.5rem}h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#424242;margin-top:1rem;margin-bottom:.5rem;padding-left:10px;border-left:4px solid #ffb74d}[_nghost-%COMP%]     button{margin-right:5rem}.desktop-view[_ngcontent-%COMP%]{padding:0 30px}@media (max-width: 600px){.tabla-container[_ngcontent-%COMP%]{padding:.5rem}table[_ngcontent-%COMP%]{font-size:.85rem}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem}table[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem}}.dButton[_ngcontent-%COMP%]{color:#fff!important;background-color:#ff9800!important}"]})};var Ni=[{path:"",component:ot},{path:"login",component:ut},{path:"available-view",loadComponent:()=>import("./chunk-EYR7RN5U.js").then(t=>t.AvailableViewComponent),canActivate:[fe(["admin","bodega"])]},{path:"dispatch-view",component:ht,canActivate:[fe(["chofer"])]},{path:"delivered-form",component:gt,canActivate:[fe(["chofer"])]},{path:"modal-map",component:he,canActivate:[fe(["admin","chofer"])]},{path:"unauthorized-component",component:_t},{path:"admin-view",component:bt,canActivate:[fe(["admin","bodega"])]},{path:"**",redirectTo:"/login"}];var ji={providers:[Kt({eventCoalescing:!0}),ci(Ni),ai()]};var Ct=class t{constructor(i){this.authService=i}title="UltimaMilla";ngOnInit(){this.authService.isLoggedIn()&&this.authService.startAutoLogout()}static \u0275fac=function(e){return new(e||t)(f(D))};static \u0275cmp=g({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(e,n){e&1&&p(0,"router-outlet")},dependencies:[oi],encapsulation:2})};ni(Ct,ji).catch(t=>console.error(t));
